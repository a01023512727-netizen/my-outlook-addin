<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>êµ¬ê¸€ ì‹œíŠ¸ ë·°ì–´</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; padding: 15px; margin: 0; background-color: #ffffff; }
        .header { color: #2b579a; font-size: 16px; font-weight: bold; margin-bottom: 12px; display: flex; align-items: center; border-bottom: 2px solid #2b579a; padding-bottom: 5px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 12px; border: 1px solid #e0e0e0; }
        th { background-color: #f3f3f3; color: #333; font-weight: bold; padding: 8px; border: 1px solid #e0e0e0; text-align: left; }
        td { padding: 8px; border: 1px solid #e0e0e0; color: #555; }
        tr:nth-child(even) { background-color: #fafafa; }
        tr:hover { background-color: #f0f7ff; }
        .loading { color: #666; font-size: 13px; font-style: italic; }
    </style>
</head>
<body>
    <div class="header">ğŸ“Š ì‹¤ì‹œê°„ ì‹œíŠ¸ ë°ì´í„°</div>
    <div id="table-container" class="loading">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>

    <script>
        // ì‚¬ìš©ìë‹˜ì´ ì£¼ì‹  ì£¼ì†Œì—ì„œ ì¶”ì¶œí•œ IDì…ë‹ˆë‹¤.
        const SHEET_ID = '1DW0Rl4lDhw8lfEF0lRxXWA21WHLBSLNVrOq4eCwQG4w';
        // êµ¬ê¸€ ì‹œíŠ¸ ë°ì´í„°ë¥¼ JSONìœ¼ë¡œ ê°€ì ¸ì˜¤ëŠ” ë§ˆë²•ì˜ ì£¼ì†Œ
        const DATA_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;

        Office.onReady(() => {
            loadSheetData();
        });

        async function loadSheetData() {
            try {
                const res = await fetch(DATA_URL);
                const text = await res.text();
                
                // êµ¬ê¸€ JSONì˜ ë¶ˆí•„ìš”í•œ ì•ë’¤ í…ìŠ¤íŠ¸ ì œê±°
                const jsonText = text.substring(47).slice(0, -2);
                const json = JSON.parse(jsonText);
                
                let tableHtml = '<table><thead><tr>';
                
                // 1. í—¤ë”(ì œëª©ì¤„) ë§Œë“¤ê¸°
                json.table.cols.forEach(col => {
                    tableHtml += `<th>${col.label || ''}</th>`;
                });
                tableHtml += '</tr></thead><tbody>';

                // 2. ë°ì´í„° ì¤„ ë§Œë“¤ê¸°
                json.table.rows.forEach(row => {
                    tableHtml += '<tr>';
                    row.c.forEach(cell => {
                        // ì…€ ê°’ì´ ë¹„ì–´ìˆì„ ê²½ìš° ì²˜ë¦¬
                        const value = cell ? (cell.f ? cell.f : cell.v) : '';
                        tableHtml += `<td>${value}</td>`;
                    });
                    tableHtml += '</tr>';
                });
                
                tableHtml += '</tbody></table>';
                document.getElementById('table-container').classList.remove('loading');
                document.getElementById('table-container').innerHTML = tableHtml;
            } catch (err) {
                console.error(err);
                document.getElementById('table-container').innerHTML = 
                    "ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨. ì‹œíŠ¸ì˜ [íŒŒì¼ > ê³µìœ  > ì›¹ì— ê²Œì‹œ]ê°€ ë˜ì–´ìˆëŠ”ì§€ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.";
            }
        }
    </script>
</body>
</html>
