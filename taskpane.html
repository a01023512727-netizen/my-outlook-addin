<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>êµ¬ê¸€ ì‹œíŠ¸ ë·°ì–´</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; padding: 15px; margin: 0; background-color: #ffffff; }
        .header { color: #2b579a; font-size: 16px; font-weight: bold; margin-bottom: 12px; border-bottom: 2px solid #2b579a; padding-bottom: 5px; }
        table { width: 100%; border-collapse: collapse; font-size: 12px; border: 1px solid #e0e0e0; }
        th { background-color: #f3f3f3; padding: 8px; border: 1px solid #e0e0e0; text-align: left; }
        td { padding: 8px; border: 1px solid #e0e0e0; color: #555; }
        tr:nth-child(even) { background-color: #fafafa; }
    </style>
</head>
<body>
    <div class="header">ğŸ“Š ì‹¤ì‹œê°„ ì‹œíŠ¸ ë°ì´í„°</div>
    <div id="table-container">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>

    <script>
        const SHEET_ID = '1-pU1y5i0p6z_Q9O-p_U-mQ_Y_v7-z_v-p_U-mQ_Y_v7';
        const DATA_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;

        Office.onReady(() => {
            loadSheetData();
        });

        async function loadSheetData() {
            try {
                const res = await fetch(DATA_URL);
                const text = await res.text();
                const json = JSON.parse(text.substring(47).slice(0, -2));
                
                let tableHtml = '<table><thead><tr>';
                json.table.cols.forEach(col => tableHtml += `<th>${col.label || ''}</th>`);
                tableHtml += '</tr></thead><tbody>';

                json.table.rows.forEach(row => {
                    tableHtml += '<tr>';
                    row.c.forEach(cell => {
                        const value = cell ? (cell.f ? cell.f : cell.v) : '';
                        tableHtml += `<td>${value}</td>`;
                    });
                    tableHtml += '</tr>';
                });
                tableHtml += '</tbody></table>';
                document.getElementById('table-container').innerHTML = tableHtml;
            } catch (err) {
                document.getElementById('table-container').innerHTML = "ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨. ì‹œíŠ¸ ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”.";
            }
        }
    </script>
</body>
</html>
